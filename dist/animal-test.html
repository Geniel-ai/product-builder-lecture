<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë™ë¬¼ìƒ í…ŒìŠ¤íŠ¸</title>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1890862001254414"
     crossorigin="anonymous"></script>
    <meta name="google-adsense-account" content="ca-pub-1890862001254414">
  <script type="module" crossorigin src="./assets/theme-DCiCAzh1.js"></script>
  <script type="module" crossorigin src="./assets/simple-page-BCWXwl99.js"></script>
  <link rel="stylesheet" crossorigin href="./assets/animal-DQ1KFk_o.css">
</head>
<body class="dark">
    <div class="container">
        <header>
            <nav class="top-right-nav">
                <a href="index.html">í™ˆìœ¼ë¡œ</a>
                <button class="btn-toggle-theme" id="theme-toggle-btn">ğŸŒ“</button>
            </nav>
        </header>
        <h1>ë‚˜ì˜ ë™ë¬¼ìƒì€?</h1>
        <p id="instructions">ì•„ë˜ íŒŒì¼ ì„ íƒ ë²„íŠ¼ì„ ëˆŒëŸ¬ ì–¼êµ´ ì‚¬ì§„ì„ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”.</p>

        <div class="teachable-machine-container">
            <input type="file" id="image-upload" accept="image/*" onchange="handleImageUpload(event)">
            <div id="image-container"></div>
            <div id="label-container"></div>
            <div id="result-display">ì‚¬ì§„ì„ ì—…ë¡œë“œí•˜ë©´ ë™ë¬¼ìƒì„ ë¶„ì„í•©ë‹ˆë‹¤.</div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest/dist/tf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@latest/dist/teachablemachine-image.min.js"></script>
    <script type="text/javascript">
        const URL = "https://teachablemachine.withgoogle.com/models/To6Q_p8IW/";

        let model, maxPredictions;
        let resultDisplay, imageContainer, labelContainer;

        async function init() {
            const modelURL = URL + "model.json";
            const metadataURL = URL + "metadata.json";

            model = await tmImage.load(modelURL, metadataURL);
            maxPredictions = model.getTotalClasses();

            resultDisplay = document.getElementById("result-display");
            imageContainer = document.getElementById("image-container");
            labelContainer = document.getElementById("label-container");
        }
        init();

        async function handleImageUpload(event) {
            const image = event.target.files[0];
            if (image) {
                const reader = new FileReader();
                reader.onload = async (e) => {
                    const img = new Image();
                    img.src = e.target.result;
                    img.onload = async () => {
                        imageContainer.innerHTML = '';
                        imageContainer.appendChild(img);
                        await predict(img);
                    }
                };
                reader.readAsDataURL(image);
            }
        }

        async function predict(imageElement) {
            resultDisplay.textContent = "ë¶„ì„ ì¤‘...";
            const prediction = await model.predict(imageElement);
            let highestProbability = 0;
            let predictedClass = "";

            for (let i = 0; i < maxPredictions; i++) {
                if (prediction[i].probability > highestProbability) {
                    highestProbability = prediction[i].probability;
                    predictedClass = prediction[i].className;
                }
            }

            if (highestProbability > 0.5) {
                let typeClass = "";
                if (predictedClass === "ê°•ì•„ì§€") typeClass = "dog-type";
                else if (predictedClass === "ê³ ì–‘ì´") typeClass = "cat-type";
                
                resultDisplay.innerHTML = `ë‹¹ì‹ ì€ <span class="${typeClass}">${predictedClass}ìƒ</span>ì…ë‹ˆë‹¤! <br><small style="font-size: 0.8rem; font-weight: normal; opacity: 0.7;">(ì •í™•ë„: ${Math.round(highestProbability * 100)}%)</small>`;
            } else {
                resultDisplay.innerHTML = "ë¶„ì„ ê²°ê³¼ê°€ ë¶ˆí™•ì‹¤í•©ë‹ˆë‹¤. ë‹¤ë¥¸ ì‚¬ì§„ìœ¼ë¡œ ì‹œë„í•´ë³´ì„¸ìš”.";
            }
        }
    </script>
</body>
</html>
